<html>
<head>
    <link rel="shortcut icon" type="image/png" href="../jasmine/lib/jasmine/jasmine_favicon.png">
    <link rel="stylesheet" type="text/css" href="../jasmine/lib/jasmine/jasmine.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script type="text/javascript" src="../jasmine/lib/jasmine/jasmine.js"></script>
    <script type="text/javascript" src="../jasmine/lib/jasmine/jasmine-html.js"></script>
    <script type="text/javascript" src="../jasmine/lib/jasmine/boot.js"></script>
    <script type="text/javascript" src="../jasmine/lib/jasmine/mock-ajax.js"></script>

    <script type="text/javascript" src="../dist/js/app.js"></script>
</head>
<body>

<script>
    SPA.init();

    describe("Check defined javascript", function() {
        it("Should be defined (SPA)", function() {
            expect(SPA.init).toBeDefined();
        });

        it("Should be defined (api)", function() {
            expect(SPA.api).toBeDefined();
        });

        it("Should be defined (data)", function() {
            expect(SPA.data.init).toBeDefined();
        });

        it("Should be defined (reversi)", function() {
            expect(SPA.reversi.init).toBeDefined();
        });

        it("Should be defined (game board)", function() {
            expect(SPA.gameBoard.init).toBeDefined();
        });

        it("Should be defined (login)", function() {
            expect(SPA.login.init).toBeDefined();
        });
    });

    describe("Mock get games requests", function() {
        beforeEach(function() {
            jasmine.Ajax.install();
        });

        it("Should show an error on a bad request", function() {
            spyOn(SPA.popup, "show");

            let request = jasmine.Ajax.requests.mostRecent();
            request.respondWith({
               "status": 401,
                "contentType": "text/plain",
                "responseText": "FORBIDDEN"
            });

            expect(SPA.popup.show).toHaveBeenCalled();
        });

        it("Should return games when api/getGames is called", function() {

        });

        afterEach(function() {
            jasmine.Ajax.uninstall();
        });
    });

    describe("Testing the popup", function() {
       it("Should show popup", function() {
           spyOn(SPA.popup, "show");
           expect(SPA.popup.show).toHaveBeenCalled();
       });
    });
</script>


</body>
</html>